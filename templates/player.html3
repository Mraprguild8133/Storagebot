<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mraprguild Cloud Player</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    :root {
      --primary: #ff5722;
      --primary-dark: #e64a19;
      --secondary: #2196f3;
      --dark: #121212;
      --dark-light: #1e1e1e;
      --text: #ffffff;
      --text-secondary: #aaaaaa;
    }
    
    body {
      background: var(--dark);
      color: var(--text);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 20px;
      overflow-x: hidden;
    }
    
    .container {
      width: 100%;
      max-width: 1000px;
      background: var(--dark-light);
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
      overflow: hidden;
    }
    
    header {
      padding: 20px;
      text-align: center;
      background: rgba(0, 0, 0, 0.4);
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    h1 {
      font-size: 2.2rem;
      background: linear-gradient(to right, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }
    
    .subtitle {
      color: var(--text-secondary);
      font-size: 1rem;
    }
    
    .player-container {
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .media-display {
      width: 100%;
      max-width: 100%;
      margin-bottom: 20px;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.4);
      background: #000;
      position: relative;
    }
    
    video, img {
      width: 100%;
      display: block;
      max-height: 70vh;
    }
    
    .custom-audio-player {
      width: 100%;
      padding: 20px;
      background: #1a1a2a;
      border-radius: 10px;
    }
    
    .media-info {
      padding: 12px 15px;
      background: rgba(30, 30, 45, 0.7);
      border-radius: 8px;
      margin-bottom: 20px;
      width: 100%;
      font-size: 0.9rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .media-type {
      background: var(--primary);
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: bold;
    }
    
    /* Custom Controls */
    .custom-controls {
      width: 100%;
      padding: 15px;
      background: rgba(0, 0, 0, 0.7);
      border-radius: 10px;
      margin-top: 15px;
    }
    
    .progress-container {
      width: 100%;
      height: 6px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 3px;
      margin-bottom: 15px;
      cursor: pointer;
      position: relative;
    }
    
    .progress {
      height: 100%;
      background: var(--primary);
      border-radius: 3px;
      width: 0%;
      position: relative;
    }
    
    .progress-handle {
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: var(--primary);
      position: absolute;
      top: 50%;
      right: 0;
      transform: translate(50%, -50%);
      display: none;
    }
    
    .progress-container:hover .progress-handle {
      display: block;
    }
    
    .time-display {
      display: flex;
      justify-content: space-between;
      margin-bottom: 15px;
      font-size: 0.9rem;
      color: var(--text-secondary);
    }
    
    .control-buttons {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin-bottom: 15px;
    }
    
    .control-btn {
      background: none;
      border: none;
      color: var(--text);
      font-size: 1.5rem;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .control-btn:hover {
      color: var(--primary);
      transform: scale(1.1);
    }
    
    .control-btn.play-pause {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--primary);
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.5rem;
    }
    
    .control-btn.play-pause:hover {
      background: var(--primary-dark);
    }
    
    .volume-control {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .volume-slider {
      width: 100px;
      -webkit-appearance: none;
      height: 5px;
      border-radius: 5px;
      background: rgba(255, 255, 255, 0.2);
      outline: none;
    }
    
    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 15px;
      height: 15px;
      border-radius: 50%;
      background: var(--primary);
      cursor: pointer;
    }
    
    .additional-controls {
      display: flex;
      justify-content: center;
      gap: 15px;
    }
    
    .settings-menu {
      position: relative;
      display: inline-block;
    }
    
    .settings-content {
      display: none;
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(30, 30, 30, 0.95);
      border-radius: 8px;
      padding: 15px;
      width: 220px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
      z-index: 100;
    }
    
    .settings-menu:hover .settings-content {
      display: block;
    }
    
    .settings-option {
      padding: 8px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .settings-option:last-child {
      border-bottom: none;
    }
    
    .settings-option:hover {
      color: var(--primary);
    }
    
    .audio-track-menu {
      display: none;
      margin-top: 8px;
      padding: 8px;
      background: rgba(40, 40, 40, 0.9);
      border-radius: 6px;
    }
    
    .audio-track-option {
      padding: 6px 10px;
      border-radius: 4px;
      cursor: pointer;
      margin-bottom: 4px;
    }
    
    .audio-track-option:hover {
      background: rgba(255, 255, 255, 0.1);
    }
    
    .audio-track-option.active {
      background: var(--primary);
      color: white;
    }
    
    .playback-speed {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
    }
    
    .speed-btn {
      padding: 5px 10px;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      border-radius: 4px;
      color: var(--text);
      cursor: pointer;
    }
    
    .speed-btn.active {
      background: var(--primary);
    }
    
    /* Controls for the player */
    .controls {
      display: flex;
      gap: 12px;
      margin-top: 15px;
      flex-wrap: wrap;
      justify-content: center;
    }
    
    .btn {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      background: linear-gradient(to right, var(--primary), var(--secondary));
      color: white;
      text-decoration: none;
      border-radius: 50px;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      border: none;
      cursor: pointer;
    }
    
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
    }
    
    .loading {
      padding: 40px;
      text-align: center;
      color: var(--text-secondary);
    }
    
    .loading i {
      font-size: 2rem;
      margin-bottom: 15px;
      color: var(--primary);
    }
    
    .error {
      padding: 30px;
      text-align: center;
      background: rgba(200, 60, 60, 0.2);
      border-radius: 10px;
      margin: 20px 0;
      border: 1px solid rgba(255, 100, 100, 0.3);
    }
    
    .error i {
      font-size: 2.5rem;
      margin-bottom: 15px;
      color: #ff6b6b;
    }
    
    footer {
      text-align: center;
      padding: 20px;
      color: var(--text-secondary);
      font-size: 0.9rem;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    /* Fullscreen mode */
    .fullscreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1000;
      background: #000;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }
    
    .fullscreen .media-display {
      width: 100%;
      max-width: 100%;
      height: 100%;
      max-height: 100%;
      border-radius: 0;
    }
    
    .fullscreen video {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }
    
    .fullscreen-controls {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      padding: 20px;
      background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
      opacity: 0;
      transition: opacity 0.3s;
    }
    
    .fullscreen:hover .fullscreen-controls {
      opacity: 1;
    }
    
    .exit-fullscreen {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(0, 0, 0, 0.5);
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      font-size: 1.2rem;
      cursor: pointer;
      z-index: 1001;
    }
    
    @media (max-width: 768px) {
      .container {
        border-radius: 8px;
      }
      
      h1 {
        font-size: 1.8rem;
      }
      
      .player-container {
        padding: 15px;
      }
      
      .controls {
        flex-direction: column;
        width: 100%;
      }
      
      .btn {
        width: 100%;
        justify-content: center;
      }
      
      .control-buttons {
        gap: 10px;
      }
      
      .control-btn {
        font-size: 1.2rem;
      }
      
      .control-btn.play-pause {
        width: 45px;
        height: 45px;
      }
      
      .settings-content {
        width: 200px;
        left: -80px;
        transform: none;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>Mraprguild Cloud Player</h1>
        <div class="subtitle">Inspired by MX Player with advanced features</div>
      </div>
      <div class="media-type">Loading...</div>
    </header>
    
    <div class="player-container">
      <div class="media-info">
        <div class="media-url">Content from secure source</div>
        <div class="media-duration">--:-- / --:--</div>
      </div>
      
      <div id="player" class="media-display">
        <div class="loading">
          <i class="fas fa-spinner fa-spin"></i>
          <p>Loading your media content...</p>
        </div>
      </div>
      
      <!-- Custom Controls -->
      <div class="custom-controls">
        <div class="progress-container" id="progress-container">
          <div class="progress" id="progress">
            <div class="progress-handle"></div>
          </div>
        </div>
        
        <div class="time-display">
          <span id="current-time">0:00</span>
          <span id="duration">0:00</span>
        </div>
        
        <div class="control-buttons">
          <button class="control-btn" id="rewind">
            <i class="fas fa-backward-step"></i>
          </button>
          
          <button class="control-btn play-pause" id="play-pause">
            <i class="fas fa-play"></i>
          </button>
          
          <button class="control-btn" id="forward">
            <i class="fas fa-forward-step"></i>
          </button>
        </div>
        
        <div class="volume-control">
          <i class="fas fa-volume-up"></i>
          <input type="range" class="volume-slider" id="volume" min="0" max="1" step="0.1" value="1">
        </div>
        
        <div class="additional-controls">
          <button class="control-btn" id="pip" title="Picture-in-Picture">
            <i class="fas fa-clone"></i>
          </button>
          
          <div class="settings-menu">
            <button class="control-btn" title="Settings">
              <i class="fas fa-sliders-h"></i>
            </button>
            <div class="settings-content">
              <div class="settings-option" id="audio-track-btn">
                <span><i class="fas fa-music"></i> Audio Track: <span id="current-audio-track">English</span></span>
                <i class="fas fa-chevron-down" id="audio-track-arrow"></i>
              </div>
              <div class="audio-track-menu" id="audio-track-menu">
                <div class="audio-track-option active" data-track="0">English</div>
                <div class="audio-track-option" data-track="1">Spanish</div>
                <div class="audio-track-option" data-track="2">French</div>
                <div class="audio-track-option" data-track="3">German</div>
              </div>
              <div class="settings-option">
                <i class="fas fa-closed-captioning"></i> Subtitles: Off
              </div>
              <div class="playback-speed">
                <span>Speed:</span>
                <button class="speed-btn active" data-speed="1">1x</button>
                <button class="speed-btn" data-speed="1.25">1.25x</button>
                <button class="speed-btn" data-speed="1.5">1.5x</button>
              </div>
            </div>
          </div>
          
          <button class="control-btn" id="fullscreen-btn" title="Fullscreen">
            <i class="fas fa-expand"></i>
          </button>
        </div>
      </div>
      
      <div class="controls">
        <a id="openBtn" target="_blank" class="btn">
          <i class="fas fa-external-link-alt"></i>Open Original
        </a>
        <a id="downloadBtn" download class="btn">
          <i class="fas fa-download"></i>Download
        </a>
      </div>
    </div>
    
    <footer>
      <p>Mraprguild Cloud Player &copy; 2025 | Inspired by MX Player</p>
    </footer>
  </div>

  <script>
    function decodeBase64Url(encoded) {
      try {
        let pad = encoded.length % 4;
        if (pad) encoded += "=".repeat(4 - pad);
        return atob(encoded.replace(/-/g, '+').replace(/_/g, '/'));
      } catch { return null; }
    }
    
    // DOM Elements
    const playerEl = document.getElementById("player");
    const mediaTypeEl = document.querySelector(".media-type");
    const openBtn = document.getElementById("openBtn");
    const downloadBtn = document.getElementById("downloadBtn");
    const playPauseBtn = document.getElementById("play-pause");
    const rewindBtn = document.getElementById("rewind");
    const forwardBtn = document.getElementById("forward");
    const volumeSlider = document.getElementById("volume");
    const progressContainer = document.getElementById("progress-container");
    const progress = document.getElementById("progress");
    const currentTimeEl = document.getElementById("current-time");
    const durationEl = document.getElementById("duration");
    const fullscreenBtn = document.getElementById("fullscreen-btn");
    const pipBtn = document.getElementById("pip");
    const speedBtns = document.querySelectorAll(".speed-btn");
    const audioTrackBtn = document.getElementById("audio-track-btn");
    const audioTrackMenu = document.getElementById("audio-track-menu");
    const audioTrackArrow = document.getElementById("audio-track-arrow");
    const currentAudioTrackEl = document.getElementById("current-audio-track");
    const audioTrackOptions = document.querySelectorAll(".audio-track-option");
    
    let mediaElement = null;
    let isPlaying = false;
    let audioTracks = [
      { name: "English", language: "en" },
      { name: "Spanish", language: "es" },
      { name: "French", language: "fr" },
      { name: "German", language: "de" }
    ];
    let currentAudioTrack = 0;
    
    function displayMedia() {
      const parts = window.location.pathname.split("/");
      const type = parts[2];
      const encoded = parts[3];
      const url = decodeBase64Url(encoded);
      
      if (!url) {
        playerEl.innerHTML = `
          <div class="error">
            <i class="fas fa-exclamation-circle"></i>
            <h2>Invalid or Expired Link</h2>
            <p>The media link is invalid or may have expired.</p>
          </div>
        `;
        mediaTypeEl.textContent = "Invalid";
        openBtn.style.display = "none";
        downloadBtn.style.display = "none";
        return;
      }
      
      // Set media type badge
      mediaTypeEl.textContent = type.charAt(0).toUpperCase() + type.slice(1);
      
      // Set button URLs
      openBtn.href = url;
      downloadBtn.href = url;
      
      // Display the appropriate media player
      let html = "";
      if (type === "video") {
        html = `
          <video>
            <source src="${url}" type="video/mp4">
            Your browser does not support the video tag.
          </video>
          <button class="exit-fullscreen" style="display: none;">
            <i class="fas fa-compress"></i>
          </button>
        `;
      } else if (type === "audio") {
        html = `
          <div class="custom-audio-player">
            <audio>
              <source src="${url}" type="audio/mpeg">
              Your browser does not support the audio element.
            </audio>
            <div style="text-align: center; margin-top: 15px;">
              <i class="fas fa-music" style="font-size: 3rem;"></i>
              <p>Audio Playing</p>
            </div>
          </div>
        `;
      } else if (type === "image") {
        html = `<img src="${url}" alt="Cloud Image">`;
      } else {
        html = `
          <div class="error">
            <i class="fas fa-times-circle"></i>
            <h2>Unsupported Media Type</h2>
            <p>Type: ${type} is not supported.</p>
          </div>
        `;
      }
      
      // Add a small delay to simulate loading (for demo purposes)
      setTimeout(() => {
        playerEl.innerHTML = html;
        mediaElement = playerEl.querySelector('video, audio');
        
        if (mediaElement) {
          setupMediaElement(mediaElement);
        }
      }, 1000);
    }
    
    function setupMediaElement(media) {
      // Event listeners for media element
      media.addEventListener('loadedmetadata', () => {
        durationEl.textContent = formatTime(media.duration);
      });
      
      media.addEventListener('timeupdate', () => {
        const currentTime = media.currentTime;
        const duration = media.duration;
        const progressPercent = (currentTime / duration) * 100;
        
        progress.style.width = `${progressPercent}%`;
        currentTimeEl.textContent = formatTime(currentTime);
      });
      
      media.addEventListener('play', () => {
        isPlaying = true;
        playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
      });
      
      media.addEventListener('pause', () => {
        isPlaying = false;
        playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
      });
      
      media.addEventListener('ended', () => {
        isPlaying = false;
        playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
        media.currentTime = 0;
      });
      
      // Play/Pause
      playPauseBtn.addEventListener('click', () => {
        if (isPlaying) {
          media.pause();
        } else {
          media.play();
        }
      });
      
      // Rewind and Forward
      rewindBtn.addEventListener('click', () => {
        media.currentTime -= 10;
      });
      
      forwardBtn.addEventListener('click', () => {
        media.currentTime += 10;
      });
      
      // Volume control
      volumeSlider.addEventListener('input', () => {
        media.volume = volumeSlider.value;
      });
      
      // Progress bar seeking
      progressContainer.addEventListener('click', (e) => {
        const pos = (e.pageX - progressContainer.getBoundingClientRect().left) / progressContainer.offsetWidth;
        media.currentTime = pos * media.duration;
      });
      
      // Fullscreen
      fullscreenBtn.addEventListener('click', () => {
        if (media.parentElement.requestFullscreen) {
          media.parentElement.requestFullscreen();
        } else if (media.parentElement.webkitRequestFullscreen) {
          media.parentElement.webkitRequestFullscreen();
        } else if (media.parentElement.msRequestFullscreen) {
          media.parentElement.msRequestFullscreen();
        }
      });
      
      // Picture in Picture
      pipBtn.addEventListener('click', () => {
        if (document.pictureInPictureElement) {
          document.exitPictureInPicture();
        } else if (media !== document.pictureInPictureElement) {
          media.requestPictureInPicture();
        }
      });
      
      // Playback speed
      speedBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          const speed = parseFloat(btn.dataset.speed);
          media.playbackRate = speed;
          
          speedBtns.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
        });
      });
      
      // Audio track selection
      setupAudioTrackSelection();
    }
    
    function setupAudioTrackSelection() {
      // Toggle audio track menu
      audioTrackBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        const isVisible = audioTrackMenu.style.display === 'block';
        audioTrackMenu.style.display = isVisible ? 'none' : 'block';
        audioTrackArrow.className = isVisible ? 
          'fas fa-chevron-down' : 'fas fa-chevron-up';
      });
      
      // Close menu when clicking elsewhere
      document.addEventListener('click', (e) => {
        if (!audioTrackBtn.contains(e.target) && !audioTrackMenu.contains(e.target)) {
          audioTrackMenu.style.display = 'none';
          audioTrackArrow.className = 'fas fa-chevron-down';
        }
      });
      
      // Select audio track
      audioTrackOptions.forEach(option => {
        option.addEventListener('click', () => {
          const trackIndex = parseInt(option.dataset.track);
          changeAudioTrack(trackIndex);
        });
      });
    }
    
    function changeAudioTrack(trackIndex) {
      // Update UI
      audioTrackOptions.forEach(option => {
        option.classList.remove('active');
      });
      audioTrackOptions[trackIndex].classList.add('active');
      currentAudioTrackEl.textContent = audioTracks[trackIndex].name;
      currentAudioTrack = trackIndex;
      
      // In a real implementation, you would switch the actual audio track here
      // For demo purposes, we'll just show a notification
      showNotification(`Audio track changed to ${audioTracks[trackIndex].name}`);
    }
    
    function showNotification(message) {
      // Create notification element
      const notification = document.createElement('div');
      notification.style.position = 'fixed';
      notification.style.bottom = '20px';
      notification.style.left = '50%';
      notification.style.transform = 'translateX(-50%)';
      notification.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';
      notification.style.color = 'white';
      notification.style.padding = '10px 20px';
      notification.style.borderRadius = '5px';
      notification.style.zIndex = '10000';
      notification.style.transition = 'opacity 0.3s';
      notification.textContent = message;
      
      document.body.appendChild(notification);
      
      // Remove notification after 3 seconds
      setTimeout(() => {
        notification.style.opacity = '0';
        setTimeout(() => {
          document.body.removeChild(notification);
        }, 300);
      }, 3000);
    }
    
    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
    }
    
    // Initialize the player when page loads
    document.addEventListener("DOMContentLoaded", displayMedia);
    
    // Fullscreen change event
    document.addEventListener('fullscreenchange', () => {
      if (document.fullscreenElement) {
        playerEl.classList.add('fullscreen');
        playerEl.querySelector('.exit-fullscreen').style.display = 'block';
      } else {
        playerEl.classList.remove('fullscreen');
        playerEl.querySelector('.exit-fullscreen').style.display = 'none';
      }
    });
    
    // Exit fullscreen button
    document.addEventListener('click', (e) => {
      if (e.target.classList.contains('exit-fullscreen') || 
          e.target.parentElement.classList.contains('exit-fullscreen')) {
        if (document.exitFullscreen) {
          document.exitFullscreen();
        } else if (document.webkitExitFullscreen) {
          document.webkitExitFullscreen();
        } else if (document.msExitFullscreen) {
          document.msExitFullscreen();
        }
      }
    });
  </script>
</body>
</html>
